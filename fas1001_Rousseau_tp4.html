<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Camilien Rousseau">

<title>fas1001_rousseau_tp4</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="fas1001_Rousseau_tp4_files/libs/clipboard/clipboard.min.js"></script>
<script src="fas1001_Rousseau_tp4_files/libs/quarto-html/quarto.js"></script>
<script src="fas1001_Rousseau_tp4_files/libs/quarto-html/popper.min.js"></script>
<script src="fas1001_Rousseau_tp4_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="fas1001_Rousseau_tp4_files/libs/quarto-html/anchor.min.js"></script>
<link href="fas1001_Rousseau_tp4_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="fas1001_Rousseau_tp4_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="fas1001_Rousseau_tp4_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="fas1001_Rousseau_tp4_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="fas1001_Rousseau_tp4_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">fas1001_rousseau_tp4</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Camilien Rousseau </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="travail-pratique-4" class="level2">
<h2 class="anchored" data-anchor-id="travail-pratique-4">Travail pratique 4</h2>
<p><strong>Question de recherche :</strong> Ma question de recherche porte sur l’analyse des statistiques de carrière de Wayne Gretzky, un joueur de hockey sur glace de renommée mondiale, afin de comprendre sa performance au fil des ans.</p>
<p><strong>Importance de la recherche :</strong> Wayne Gretzky est considéré comme l’un des plus grands joueurs de hockey de tous les temps, et ses statistiques de carrière suscitent un intérêt considérable parmi les amateurs de hockey, les analystes sportifs et les chercheurs. L’analyse de ses statistiques peut fournir des insights sur son style de jeu, le développement de ses compétences et son impact sur le jeu.</p>
<section id="données" class="level3">
<h3 class="anchored" data-anchor-id="données">Données</h3>
<p>Les variables <code>Season</code> et <code>TM</code> représentent respectivement la saison et l’équipe du joueur. La variable <code>GP</code> indique le nombre de matchs joués par le joueur, avec une moyenne de 74.35 matchs.</p>
<p>Les variables <code>G</code>, <code>A</code>, et <code>P</code> représentent respectivement les buts marqués, les aides réalisées et le total de points (but + aide) du joueur. Le joueur a en moyenne marqué 44.70 buts (<code>G</code>), réalisé 98.15 aides (<code>A</code>), totalisant ainsi 142.8 points (<code>P</code>).</p>
<p>La variable <code>+/-</code> représente le différentiel de buts à égalité de force du joueur. En moyenne, ce différentiel est de 26.00.</p>
<p>La variable <code>PIM</code> représente le nombre de minutes de pénalité du joueur, avec une moyenne de 28.85 minutes.</p>
<p>Les variables <code>PPG</code> et <code>PPA</code> représentent respectivement les buts marqués et les aides réalisées en avantage numérique. En moyenne, le joueur a marqué 10.20 buts en avantage numérique (<code>PPG</code>) et réalisé 34.30 aides en avantage numérique (<code>PPA</code>).</p>
<p>Les variables <code>SHG</code> et <code>SHA</code> représentent respectivement les buts marqués et les aides réalisées en infériorité numérique. Le joueur a en moyenne marqué 3.65 buts en infériorité numérique (<code>SHG</code>) et réalisé 3.8 aides en infériorité numérique (<code>SHA</code>).</p>
<p>Les variables <code>GWG</code> et <code>OTG</code> représentent respectivement les buts gagnants et les buts marqués en prolongation par le joueur. En moyenne, le joueur a marqué 4.55 buts gagnants (<code>GWG</code>) et 0.125 but en prolongation (<code>OTG</code>).</p>
<p>La variable <code>S</code> représente le nombre total de tirs au but du joueur, avec une moyenne de 254.4 tirs.</p>
<p>La variable <code>S%</code> représente le pourcentage de réussite des tirs du joueur, avec une moyenne de 16.48%.</p>
<p>La variable <code>Pts_GP</code> représente le nombre de points par match du joueur, avec une moyenne de 1.8951 points par match.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### Scraping de données de Hockeys sur glace ####</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 1 - Libraries ----</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.4.4     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.0
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate) <span class="co"># Package pour gérer des données temporelles</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("rvest")</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rvest) <span class="co"># Package pour le scraping</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: le package 'rvest' a été compilé avec la version R 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attachement du package : 'rvest'

L'objet suivant est masqué depuis 'package:readr':

    guess_encoding</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 2 - Scraping ----</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>hockey_data <span class="ot">&lt;-</span> <span class="fu">read_html</span>(<span class="st">"https://www.statmuse.com/nhl/player/wayne-gretzky-2501"</span>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>hockey_data1 <span class="ot">&lt;-</span> hockey_data <span class="sc">%&gt;%</span> </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_elements</span>(<span class="st">"table"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_table</span>(<span class="at">fill =</span> <span class="cn">TRUE</span>) </span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Nettoyage: </span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>is_convertible <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">all</span>(<span class="fu">grepl</span>(<span class="st">"^-?</span><span class="sc">\\</span><span class="st">d+</span><span class="sc">\\</span><span class="st">.?</span><span class="sc">\\</span><span class="st">d*$"</span>, x, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>))</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>hockey_data1 <span class="ot">&lt;-</span> hockey_data1 <span class="sc">%&gt;%</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Season =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="sc">-</span><span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is_convertible, as.numeric) <span class="sc">%&gt;%</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">ncol</span>(.)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">TM =</span> <span class="fu">replace</span>(TM, TM <span class="sc">==</span> <span class="st">"TOT"</span>, <span class="st">"STL"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Season =</span> <span class="fu">gsub</span>(<span class="st">"19"</span>, <span class="st">""</span>, Season))</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(hockey_data1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 20
Columns: 16
$ Season &lt;chr&gt; "79-80", "80-81", "81-82", "82-83", "83-84", "84-85", "85-86", …
$ TM     &lt;chr&gt; "EDM", "EDM", "EDM", "EDM", "EDM", "EDM", "EDM", "EDM", "EDM", …
$ GP     &lt;dbl&gt; 79, 80, 80, 80, 74, 80, 80, 79, 64, 78, 73, 78, 74, 45, 81, 48,…
$ G      &lt;dbl&gt; 51, 55, 92, 71, 87, 73, 52, 62, 40, 54, 40, 41, 31, 16, 38, 11,…
$ A      &lt;dbl&gt; 86, 109, 120, 125, 118, 135, 163, 121, 109, 114, 102, 122, 90, …
$ P      &lt;dbl&gt; 137, 164, 212, 196, 205, 208, 215, 183, 149, 168, 142, 163, 121…
$ `+/-`  &lt;dbl&gt; 14, 41, 80, 61, 78, 100, 71, 69, 39, 15, 8, 30, -12, 6, -25, -2…
$ PIM    &lt;dbl&gt; 21, 28, 26, 59, 39, 52, 46, 28, 24, 26, 42, 16, 34, 6, 20, 6, 3…
$ PPG    &lt;dbl&gt; 13, 15, 18, 18, 20, 8, 11, 13, 9, 11, 10, 8, 12, 0, 14, 3, 6, 6…
$ PPA    &lt;dbl&gt; 22, 38, 39, 36, 27, 36, 43, 33, 40, 42, 30, 51, 42, 24, 47, 19,…
$ SHG    &lt;dbl&gt; 1, 4, 6, 6, 12, 11, 3, 7, 5, 5, 4, 0, 2, 2, 4, 0, 1, 0, 0, 0
$ SHA    &lt;dbl&gt; 1, 3, 2, 4, 11, 7, 15, 6, 4, 10, 2, 1, 2, 1, 3, 3, 0, 1, 0, 0
$ GWG    &lt;dbl&gt; 6, 3, 12, 9, 11, 7, 6, 4, 3, 5, 4, 5, 2, 1, 0, 1, 3, 2, 4, 3
$ OTG    &lt;int&gt; NA, NA, NA, NA, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0
$ S      &lt;dbl&gt; 284, 261, 370, 348, 326, 354, 350, 288, 211, 303, 236, 212, 215…
$ `S%`   &lt;dbl&gt; 18.0, 21.1, 24.9, 20.4, 26.7, 20.6, 14.9, 21.5, 19.0, 17.8, 16.…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3 - Analyse ----</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 3.1 Analyse statisque:</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Analyse de points par match / but par match et passe par match</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculer les buts par match (B/M)</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>goals_per_game <span class="ot">&lt;-</span> <span class="fu">sum</span>(hockey_data1<span class="sc">$</span>G) <span class="sc">/</span> <span class="fu">sum</span>(hockey_data1<span class="sc">$</span>GP)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculer les passes par match (A/M)</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>assists_per_game <span class="ot">&lt;-</span> <span class="fu">sum</span>(hockey_data1<span class="sc">$</span>A) <span class="sc">/</span> <span class="fu">sum</span>(hockey_data1<span class="sc">$</span>GP)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculer les points par match (Pts/M)</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>points_per_game <span class="ot">&lt;-</span> <span class="fu">sum</span>(hockey_data1<span class="sc">$</span>P) <span class="sc">/</span> <span class="fu">sum</span>(hockey_data1<span class="sc">$</span>GP)</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>goals_per_game <span class="co">#0.6</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6012105</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>assists_per_game <span class="co">#1.32</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.320108</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>points_per_game <span class="co">#1.92</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.921318</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Sommaire des statistiques: </span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>summary_stats <span class="ot">&lt;-</span> <span class="fu">summary</span>(hockey_data1)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>summary_stats</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Season               TM                  GP              G        
 Length:20          Length:20          Min.   :45.00   Min.   : 9.00  
 Class :character   Class :character   1st Qu.:73.75   1st Qu.:24.50  
 Mode  :character   Mode  :character   Median :79.00   Median :40.50  
                                       Mean   :74.35   Mean   :44.70  
                                       3rd Qu.:80.00   3rd Qu.:56.75  
                                       Max.   :82.00   Max.   :92.00  
                                                                      
       A                P              +/-              PIM       
 Min.   : 37.00   Min.   : 48.0   Min.   :-25.00   Min.   : 6.00  
 1st Qu.: 77.25   1st Qu.:100.8   1st Qu.:-11.25   1st Qu.:20.75  
 Median :105.50   Median :145.5   Median : 14.50   Median :28.00  
 Mean   : 98.15   Mean   :142.8   Mean   : 26.00   Mean   :28.85  
 3rd Qu.:120.25   3rd Qu.:186.2   3rd Qu.: 63.00   3rd Qu.:35.25  
 Max.   :163.00   Max.   :215.0   Max.   :100.00   Max.   :59.00  
                                                                  
      PPG             PPA             SHG             SHA            GWG       
 Min.   : 0.00   Min.   :19.00   Min.   : 0.00   Min.   : 0.0   Min.   : 0.00  
 1st Qu.: 6.00   1st Qu.:26.50   1st Qu.: 0.75   1st Qu.: 1.0   1st Qu.: 2.75  
 Median :10.50   Median :36.00   Median : 3.50   Median : 2.5   Median : 4.00  
 Mean   :10.20   Mean   :34.30   Mean   : 3.65   Mean   : 3.8   Mean   : 4.55  
 3rd Qu.:13.25   3rd Qu.:41.25   3rd Qu.: 5.25   3rd Qu.: 4.5   3rd Qu.: 6.00  
 Max.   :20.00   Max.   :51.00   Max.   :12.00   Max.   :15.0   Max.   :12.00  
                                                                               
      OTG              S               S%       
 Min.   :0.000   Min.   :132.0   Min.   : 6.80  
 1st Qu.:0.000   1st Qu.:208.5   1st Qu.:11.70  
 Median :0.000   Median :248.5   Median :17.35  
 Mean   :0.125   Mean   :254.4   Mean   :16.48  
 3rd Qu.:0.000   3rd Qu.:308.8   3rd Qu.:20.45  
 Max.   :1.000   Max.   :370.0   Max.   :26.70  
 NA's   :4                                      </code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Analyse de corrélation entre les pénalités et les points/tirs au but ####</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculer la correlation entre PIM et Pts</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>correlation_pts_pim <span class="ot">&lt;-</span> <span class="fu">cor</span>(hockey_data1<span class="sc">$</span>PIM, hockey_data1<span class="sc">$</span>P)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co">#  Calculer la correlation entre PIM et Shots</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>correlation_shots_pim <span class="ot">&lt;-</span> <span class="fu">cor</span>(hockey_data1<span class="sc">$</span>PIM, hockey_data1<span class="sc">$</span>S)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>correlation_pts_pim <span class="co">#0.675</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6755559</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>correlation_shots_pim <span class="co">#0.711</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7109141</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3.2 Graphique ----</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Nuage de point sur la performance de Gretzky au travers des saisons:</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>team_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"EDM"</span> <span class="ot">=</span> <span class="st">"#FF4C00"</span>,  <span class="co"># Orange</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"LAK"</span> <span class="ot">=</span> <span class="st">"black"</span>,    <span class="co"># Noir</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"STL"</span> <span class="ot">=</span> <span class="st">"blue"</span>,  <span class="co"># Navy Blue</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"NYR"</span> <span class="ot">=</span> <span class="st">"red"</span>)  <span class="co"># Rouge/Bleu</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>graph1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> hockey_data1,</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">aes</span>(<span class="at">x =</span> Season, <span class="at">y =</span> P, <span class="at">color =</span> TM)) <span class="sc">+</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> team_colors) <span class="sc">+</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Les points de Gretzky durant sa carrière"</span>,</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Saison"</span>,</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Points"</span>) <span class="sc">+</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(hockey_data1<span class="sc">$</span>P) <span class="sc">+</span> <span class="dv">10</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>graph1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="fas1001_Rousseau_tp4_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># graphique 2:</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>hockey_data1 <span class="ot">&lt;-</span> hockey_data1 <span class="sc">%&gt;%</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Pts_GP =</span> P <span class="sc">/</span> GP)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>graph2 <span class="ot">&lt;-</span>  <span class="fu">ggplot</span>(<span class="at">data =</span> hockey_data1,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">aes</span>(<span class="at">x =</span> Season, <span class="at">y =</span> Pts_GP, <span class="at">color =</span> TM)) <span class="sc">+</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> team_colors)<span class="sc">+</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Points par match pour les différents saisons de Gretzky"</span>,</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Saison"</span>,</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Points par match"</span>) <span class="sc">+</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(hockey_data1<span class="sc">$</span>Pts_GP) <span class="sc">+</span> <span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>graph2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="fas1001_Rousseau_tp4_files/figure-html/unnamed-chunk-1-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="interprétation-des-graphiques" class="level3">
<h3 class="anchored" data-anchor-id="interprétation-des-graphiques">Interprétation des graphiques:</h3>
<p>Dans les deux graphiques nous pouvons observer une forte production de points au début de sa carrière lorsqu’il était avec les Oilers d’Edmonton, qui a graduellement diminuer au fur et a mesure que sa carrière continue. Vu que le premier graphique ne prend pas en compte le nombre de match joué a chaque saison dans son calcul de somme des points, et bien nous proposons le deuxième graphique pour illustrer sa moyenne de points par match permettant ainsi d’avoir une vue équitable sur la production de points de Wayne Gretzky.</p>
<p>Lors de nos analyses, nous avons pu observer une corrélation positive entre son nombre de points par saison et le nombre de minute de pénalité, ce qui veut dire que lorsque son nombre de minute de pénalité augmente et bien son nombre de point augmente également. Cela ne veut pas dire qu’il y a une causalité entre les deux.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>